"use strict";(self.webpackChunkcarifacts=self.webpackChunkcarifacts||[]).push([[220],{3220:(pe,Z,a)=>{a.r(Z),a.d(Z,{AccountModule:()=>de});var p=a(6895),n=a(433),f=a(3317),_=a(2340),e=a(1571),g=a(561);class v{constructor(t,r){this.defaultTranscoder=t,this.subject=r}has(t){return this.subject.has(t)}get(t,r){return this.subject.get(t,r??this.defaultTranscoder)}set(t,r,o){this.subject.set(t,r,o??this.defaultTranscoder)}remove(t){this.subject.remove(t)}clear(){this.subject.clear()}withDefaultTranscoder(t){return new v(t,this.subject)}}class S{constructor(t){this.defaultTranscoder=t}get(t,r){const o=this.getItem(t);return void 0!==o?(r??this.defaultTranscoder).decode(o):void 0}set(t,r,o){this.setItem(t,(o??this.defaultTranscoder).encode(r))}withDefaultTranscoder(t){return new v(t,this)}}const T={JSON:new class I{encode(t){return JSON.stringify(t)}decode(t){try{return JSON.parse(t)}catch{return}}},STRING:new class q{encode(t){return t}decode(t){return t}},BOOLEAN:new class N{encode(t){return t.toString()}decode(t){return"true"===t||"false"!==t&&void 0}},NUMBER:new class x{encode(t){return t.toString()}decode(t){const r=Number(t);return Number.isFinite(r)?r:void 0}},DATE_ISO_STRING:new class J{encode(t){return t.toISOString()}decode(t){const r=Date.parse(t);return isNaN(r)?void 0:new Date(r)}},DATE_EPOCH_TIME:new class R{encode(t){return t.valueOf().toString()}decode(t){const r=parseInt(t,10);return isNaN(r)?void 0:new Date(r)}}};class y extends S{constructor(){super(T.JSON),this.storage=new Map}has(t){return this.storage.has(t)}remove(t){this.storage.delete(t)}clear(){this.storage.clear()}getItem(t){if(this.storage.has(t))return this.storage.get(t)}setItem(t,r){this.storage.set(t,r)}}class F extends S{constructor(t){super(T.JSON),this.storage=t}has(t){return null!==this.storage.getItem(t)}remove(t){this.storage.removeItem(t)}clear(){this.storage.clear()}getItem(t){const r=this.storage.getItem(t);return null!==r?r:void 0}setItem(t,r){return this.storage.setItem(t,r)}}function C(s){if(!s)return!1;try{const t=Date.now(),r=`storage-test-entry-${t}`,o=`storage-test-value-${t}`;s.setItem(r,o);const i=s.getItem(r);return s.removeItem(r),i===o}catch{return!1}}const O=new e.OlP("SESSION_STORAGE",{providedIn:"root",factory:function M(){return function E(){try{if(typeof sessionStorage<"u")return C(sessionStorage)}catch{}return!1}()?new F(sessionStorage):new y}});new e.OlP("LOCAL_STORAGE",{providedIn:"root",factory:function L(){return function Y(){try{if(typeof localStorage<"u")return C(localStorage)}catch{}return!1}()?new F(localStorage):new y}});let k=(()=>{class s{constructor(r){this.storage=r}get(r){return this.storage.get(r)}set(r,o){this.storage.set(r,o)}delete(r){this.storage.remove(r)}deleteAll(){this.storage.clear()}}return s.\u0275fac=function(r){return new(r||s)(e.LFG(O))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var A=a(8034),P=a(9207),D=a(4460),l=a(2605),b=a(4144);function j(s,t){1&s&&(e.TgZ(0,"span",22),e._uU(1,"Email is required"),e.qZA())}function Q(s,t){1&s&&(e.TgZ(0,"span",22),e._uU(1,"Password is required"),e.qZA())}let V=(()=>{class s{constructor(r,o,i,u,d,c,m,h){this.fb=r,this.httpService=o,this.cacheService=i,this.encryptionService=u,this.modalDialogService=d,this.userInfoService=c,this.router=m,this.activatedRoute=h,this.cacheKey=_.N.cacheKey,this.submitted=!1,this.returnUrl="/"}ngOnInit(){this.initForm(),this.returnUrl=this.activatedRoute.snapshot.queryParams.returnUrl||"/";var r=this.userInfoService.getLoggedInUser();null!=r&&null!=r&&"null"!=r&&this.router.navigateByUrl(this.returnUrl).then(o=>{o||this.router.navigateByUrl("/")})}initForm(){let r=this.cacheService.get(this.cacheKey);this.loginForm=this.fb.group({email:[null!=r?r.email:"",[n.kI.required]],password:[null!=r?this.encryptionService.decrypt(r.password):"",[n.kI.required]],rememberMe:[!1]})}get loginFrm(){return this.loginForm.controls}submit(){this.submitted=!0,this.loginForm.invalid||this.httpService.httpPost(f.F.account.login,{email:this.loginFrm.email.value,password:this.loginFrm.password.value}).subscribe(o=>{if(o.success){if(this.loginFrm.rememberMe.value){const i={email:this.loginFrm.email.value,password:this.encryptionService.encrypt(this.loginFrm.password.value)};this.cacheService.set(this.cacheKey,i)}else this.cacheService.delete(this.cacheKey);this.userInfoService.setUser(o.data),this.returnUrl="/"==this.returnUrl&&o.data.isAdmin?"/admin":this.returnUrl,this.router.navigateByUrl(this.returnUrl).then(i=>{i||this.router.navigateByUrl("/")})}})}}return s.\u0275fac=function(r){return new(r||s)(e.Y36(n.qu),e.Y36(g.O),e.Y36(k),e.Y36(A.C),e.Y36(P.X),e.Y36(D.$),e.Y36(l.F0),e.Y36(l.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-login"]],decls:37,vars:3,consts:[[3,"formGroup","ngSubmit"],[1,"form-outline","mb-4"],["for","form2Example1",1,"form-label"],["matInput","","type","email","id","form2Example1","formControlName","email",1,"form-control"],["class","text-danger d-block mt-2",4,"ngIf"],["for","form2Example2",1,"form-label"],["matInput","","type","password","id","form2Example2","formControlName","password",1,"form-control"],[1,"row","mb-4"],[1,"col","d-flex","justify-content-center"],[1,"form-check"],["type","checkbox","id","form2Example31","formControlName","rememberMe",1,"form-check-input"],["for","form2Example31",1,"form-check-label"],[1,"col"],["routerLink","/account/forgot-password"],["type","submit",1,"btn","btn-primary","d-block","mx-auto","btn-block","mb-4"],[1,"text-center"],["routerLink","/account/register"],["type","button",1,"btn","btn-link","btn-floating","mx-1"],[1,"fab","fa-facebook-f"],[1,"fab","fa-google"],[1,"fab","fa-twitter"],[1,"fab","fa-github"],[1,"text-danger","d-block","mt-2"]],template:function(r,o){1&r&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return o.submit()}),e.TgZ(1,"div",1)(2,"label",2),e._uU(3,"Email address"),e.qZA(),e._UZ(4,"input",3),e.YNc(5,j,2,0,"span",4),e.qZA(),e.TgZ(6,"div",1)(7,"label",5),e._uU(8,"Password"),e.qZA(),e._UZ(9,"input",6),e.YNc(10,Q,2,0,"span",4),e.qZA(),e.TgZ(11,"div",7)(12,"div",8)(13,"div",9),e._UZ(14,"input",10),e.TgZ(15,"label",11),e._uU(16," Remember me "),e.qZA()()(),e.TgZ(17,"div",12)(18,"a",13),e._uU(19,"Forgot password?"),e.qZA()()(),e.TgZ(20,"button",14),e._uU(21,"Sign in"),e.qZA(),e.TgZ(22,"div",15)(23,"p"),e._uU(24,"Not a member? "),e.TgZ(25,"a",16),e._uU(26,"Register"),e.qZA()(),e.TgZ(27,"p"),e._uU(28,"or sign up with:"),e.qZA(),e.TgZ(29,"button",17),e._UZ(30,"i",18),e.qZA(),e.TgZ(31,"button",17),e._UZ(32,"i",19),e.qZA(),e.TgZ(33,"button",17),e._UZ(34,"i",20),e.qZA(),e.TgZ(35,"button",17),e._UZ(36,"i",21),e.qZA()()()),2&r&&(e.Q6J("formGroup",o.loginForm),e.xp6(5),e.Q6J("ngIf",o.submitted&&(null==o.loginFrm.email.errors?null:o.loginFrm.email.errors.required)),e.xp6(5),e.Q6J("ngIf",o.submitted&&(null==o.loginFrm.password.errors?null:o.loginFrm.password.errors.required)))},dependencies:[p.O5,l.rH,n._Y,n.Fj,n.Wl,n.JJ,n.JL,n.sg,n.u,b.Nt],styles:["form[_ngcontent-%COMP%]{width:600px;margin:auto;padding:45px;border:thin solid rgba(128,128,128,.4901960784);box-shadow:0 10px 40px #80808063;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]}),s})();class U{static ConfirmPassword(t){return r=>t(r.value)?null:{notSame:!0}}static SelectFromList(t){return r=>{let o=r.value;return t(o)||null==o||""==o?null:{validSelection:!0}}}}function G(s,t){1&s&&(e.TgZ(0,"span"),e._uU(1,"Email is required"),e.qZA())}function $(s,t){1&s&&(e.TgZ(0,"span"),e._uU(1,"Password is required"),e.qZA())}function B(s,t){1&s&&(e.TgZ(0,"span"),e._uU(1,"Invalid Password"),e.qZA())}function z(s,t){1&s&&(e.TgZ(0,"span"),e._uU(1,"Confirm Password is required"),e.qZA())}function H(s,t){1&s&&(e.TgZ(0,"span"),e._uU(1,"Password and Confirm Password is not same"),e.qZA())}let K=(()=>{class s{constructor(r,o,i){this.fb=r,this.httpService=o,this.router=i,this.submitted=!1}ngOnInit(){this.initForm()}initForm(){this.registerForm=this.fb.group({name:["",[n.kI.required]],email:["",[n.kI.required]],password:["",[n.kI.required,n.kI.pattern("^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$")]],confirmPassword:["",[]]}),this.setConfirmPwdValidator()}get regForm(){return this.registerForm.controls}matchPassword(){return""==this.regForm.confirmPassword.value||this.regForm.password.value==this.regForm.confirmPassword.value}setConfirmPwdValidator(){this.registerForm.controls.confirmPassword.setValidators([n.kI.required,U.ConfirmPassword(r=>this.matchPassword())]),this.registerForm.controls.confirmPassword.updateValueAndValidity()}submit(){this.submitted=!0,this.registerForm.invalid||this.httpService.httpPost(f.F.account.register,{name:this.regForm.name.value,email:this.regForm.email.value,password:this.regForm.password.value}).subscribe(o=>{o.success&&this.router.navigate(["/account/login"])})}}return s.\u0275fac=function(r){return new(r||s)(e.Y36(n.qu),e.Y36(g.O),e.Y36(l.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-register"]],decls:49,vars:6,consts:[[1,"container"],[1,"row","justify-content-center"],[1,"col-md-10","col-lg-6","col-xl-5","order-2","order-lg-1","floatingform"],[1,"text-center","h1","fw-bold"],[1,"mx-1","mx-md-4",3,"formGroup","ngSubmit"],[1,"d-flex","flex-row","align-items-center","mb-4"],[1,"form-outline","flex-fill","mb-0"],["for","form3Example1c",1,"form-label"],["type","text","id","form3Example1c","formControlName","name",1,"form-control"],["for","form3Example3c",1,"form-label"],["type","email","id","form3Example3c","formControlName","email",1,"form-control"],[4,"ngIf"],["for","form3Example4c",1,"form-label"],["type","password","id","form3Example4c","formControlName","password",1,"form-control",3,"change"],["for","form3Example4cd",1,"form-label"],["type","password","id","form3Example4cd","formControlName","confirmPassword",1,"form-control"],[1,"d-flex","justify-content-center","mx-4","mb-3","mb-lg-4"],["type","submit",1,"btn","btn-primary","btn-lg"],[1,"text-center"],["routerLink","/account/login"],["type","button",1,"btn","btn-link","btn-floating","mx-1"],[1,"fab","fa-facebook-f"],[1,"fab","fa-google"],[1,"fab","fa-twitter"],[1,"fab","fa-github"]],template:function(r,o){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),e._uU(4,"Sign up"),e.qZA(),e.TgZ(5,"form",4),e.NdJ("ngSubmit",function(){return o.submit()}),e.TgZ(6,"div",5)(7,"div",6)(8,"label",7),e._uU(9,"Your Name"),e.qZA(),e._UZ(10,"input",8),e.qZA()(),e.TgZ(11,"div",5)(12,"div",6)(13,"label",9),e._uU(14,"Your Email"),e.qZA(),e._UZ(15,"input",10),e.YNc(16,G,2,0,"span",11),e.qZA()(),e.TgZ(17,"div",5)(18,"div",6)(19,"label",12),e._uU(20,"Password"),e.qZA(),e.TgZ(21,"input",13),e.NdJ("change",function(){return o.setConfirmPwdValidator()}),e.qZA(),e.YNc(22,$,2,0,"span",11),e.YNc(23,B,2,0,"span",11),e.qZA()(),e.TgZ(24,"div",5)(25,"div",6)(26,"label",14),e._uU(27,"Repeat your password"),e.qZA(),e._UZ(28,"input",15),e.YNc(29,z,2,0,"span",11),e.YNc(30,H,2,0,"span",11),e.qZA()(),e.TgZ(31,"div",16)(32,"button",17),e._uU(33,"Register"),e.qZA()()(),e.TgZ(34,"div",18)(35,"p"),e._uU(36,"Already a member? "),e.TgZ(37,"a",19),e._uU(38,"Login"),e.qZA()(),e.TgZ(39,"p"),e._uU(40,"or sign up with:"),e.qZA(),e.TgZ(41,"button",20),e._UZ(42,"i",21),e.qZA(),e.TgZ(43,"button",20),e._UZ(44,"i",22),e.qZA(),e.TgZ(45,"button",20),e._UZ(46,"i",23),e.qZA(),e.TgZ(47,"button",20),e._UZ(48,"i",24),e.qZA()()()()()),2&r&&(e.xp6(5),e.Q6J("formGroup",o.registerForm),e.xp6(11),e.Q6J("ngIf",o.submitted&&(null==o.regForm.email.errors?null:o.regForm.email.errors.required)),e.xp6(6),e.Q6J("ngIf",o.submitted&&(null==o.regForm.password.errors?null:o.regForm.password.errors.required)),e.xp6(1),e.Q6J("ngIf",o.submitted&&(null==o.regForm.password.errors?null:o.regForm.password.errors.pattern)),e.xp6(6),e.Q6J("ngIf",o.submitted&&(null==o.regForm.confirmPassword.errors?null:o.regForm.confirmPassword.errors.required)),e.xp6(1),e.Q6J("ngIf",o.submitted&&(null==o.regForm.confirmPassword.errors?null:o.regForm.confirmPassword.errors.notSame)))},dependencies:[p.O5,l.rH,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u],styles:[".floatingform[_ngcontent-%COMP%]{width:600px;margin:auto;padding:45px;border:thin solid rgba(128,128,128,.4901960784);box-shadow:0 10px 40px #80808063;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]}),s})();const X=function(){return["/account/login"]},W=function(){return["/account/register"]};let ee=(()=>{class s{constructor(r,o){this.httpService=r,this.router=o}resetPassword(){this.httpService.httpPost(f.F.account.resetPassword,{email:this.email}).subscribe(r=>{})}}return s.\u0275fac=function(r){return new(r||s)(e.Y36(g.O),e.Y36(l.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-forgot-password"]],decls:17,vars:5,consts:[[1,"card","text-center",2,"width","300px"],[1,"card-header","h5","text-white","bg-primary"],[1,"card-body","px-5"],[1,"card-text","py-2"],[1,"form-outline"],["matInput","","type","email","id","typeEmail",1,"form-control","my-3",3,"ngModel","ngModelChange"],["for","typeEmail",1,"form-label"],[1,"btn","btn-primary","w-100",3,"click"],[1,"d-flex","justify-content-between","mt-4"],[1,"",3,"routerLink"]],template:function(r,o){1&r&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"Password Reset"),e.qZA(),e.TgZ(3,"div",2)(4,"p",3),e._uU(5," Enter your email address and we'll send you an email with instructions to reset your password. "),e.qZA(),e.TgZ(6,"div",4)(7,"input",5),e.NdJ("ngModelChange",function(u){return o.email=u}),e.qZA(),e.TgZ(8,"label",6),e._uU(9,"Email input"),e.qZA()(),e.TgZ(10,"a",7),e.NdJ("click",function(){return o.resetPassword()}),e._uU(11,"Reset password"),e.qZA(),e.TgZ(12,"div",8)(13,"a",9),e._uU(14,"Login"),e.qZA(),e.TgZ(15,"a",9),e._uU(16,"Register"),e.qZA()()()()),2&r&&(e.xp6(7),e.Q6J("ngModel",o.email),e.xp6(6),e.Q6J("routerLink",e.DdM(3,X)),e.xp6(2),e.Q6J("routerLink",e.DdM(4,W)))},dependencies:[l.rH,n.Fj,n.JJ,n.On,b.Nt]}),s})();var te=a(3968),re=a(6538),oe=a(9646),se=a(1005);function ne(s,t){1&s&&(e.TgZ(0,"span"),e._uU(1,"Password is required"),e.qZA())}function ie(s,t){1&s&&(e.TgZ(0,"span"),e._uU(1,"Invalid Password"),e.qZA())}function ae(s,t){1&s&&(e.TgZ(0,"span"),e._uU(1,"Confirm Password is required"),e.qZA())}function le(s,t){1&s&&(e.TgZ(0,"span"),e._uU(1,"Password and Confirm Password is not same"),e.qZA())}const ue=function(){return["/account/login"]},me=[{path:"login",component:V},{path:"register",component:K},{path:"forgot-password",component:ee},{path:"reset-password/:id/:date",component:(()=>{class s{constructor(r,o,i,u,d,c){this.fb=r,this.activatedRoute=o,this.encryptionService=i,this.modalDialogService=u,this.router=d,this.httpService=c,this.submitted=!1,o.params.subscribe(m=>{let w=m.date;this.decrypUserId=this.encryptionService.decrypt(m.id),this.expiryDateTime=new Date(this.encryptionService.decrypt(w))})}ngOnInit(){const r=new Date,o=r.getUTCFullYear(),i=r.getUTCMonth()+1,u=r.getUTCDate(),d=r.getUTCHours(),c=r.getUTCMinutes(),m=r.getUTCSeconds();let w=new Date(`${o}-${i}-${u} ${d}:${c}:${m}`)-this.expiryDateTime,ce=w>9e5?0:w;(0,oe.of)([]).pipe((0,se.g)(ce)).subscribe(we=>{this.modalDialogService.error("Link expired"),this.router.navigate(["/"])}),this.initForm()}initForm(){this.resetForm=this.fb.group({password:["",[n.kI.required,n.kI.pattern("^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$")]],confirmPassword:["",[]]}),this.setConfirmPwdValidator()}get resetFrm(){return this.resetForm.controls}matchPassword(){return""==this.resetFrm.confirmPassword.value||this.resetFrm.password.value==this.resetFrm.confirmPassword.value}setConfirmPwdValidator(){this.resetForm.controls.confirmPassword.setValidators([n.kI.required,U.ConfirmPassword(r=>this.matchPassword())]),this.resetForm.controls.confirmPassword.updateValueAndValidity()}confirm(){this.submitted=!0,this.resetForm.invalid||this.httpService.httpPost(f.F.account.updatePassword,{id:this.decrypUserId,password:this.resetFrm.password.value}).subscribe(o=>{})}}return s.\u0275fac=function(r){return new(r||s)(e.Y36(n.qu),e.Y36(l.gz),e.Y36(A.C),e.Y36(P.X),e.Y36(l.F0),e.Y36(g.O))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-reset-password"]],decls:22,vars:7,consts:[[1,"card","text-center",2,"width","300px"],[1,"card-header","h5","text-white","bg-primary"],[1,"card-body","px-5"],[3,"formGroup"],[1,"form-outline"],["matInput","","type","password","id","typeEmail","formControlName","password",1,"form-control","my-3"],["for","typeEmail",1,"form-label"],[4,"ngIf"],["matInput","","type","text","id","typeEmail","formControlName","confirmPassword",1,"form-control","my-3"],[1,"btn","btn-primary","w-100",3,"click"],[1,"d-flex","justify-content-between","mt-4"],[1,"",3,"routerLink"]],template:function(r,o){1&r&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"Password Reset"),e.qZA(),e.TgZ(3,"div",2)(4,"form",3)(5,"div",4),e._UZ(6,"input",5),e.TgZ(7,"label",6),e._uU(8,"New Password"),e.qZA(),e.YNc(9,ne,2,0,"span",7),e.YNc(10,ie,2,0,"span",7),e.qZA(),e.TgZ(11,"div",4),e._UZ(12,"input",8),e.TgZ(13,"label",6),e._uU(14,"Confirm Password"),e.qZA(),e.YNc(15,ae,2,0,"span",7),e.YNc(16,le,2,0,"span",7),e.qZA()(),e.TgZ(17,"a",9),e.NdJ("click",function(){return o.confirm()}),e._uU(18,"Confirm"),e.qZA(),e.TgZ(19,"div",10)(20,"a",11),e._uU(21,"Login"),e.qZA()()()()),2&r&&(e.xp6(4),e.Q6J("formGroup",o.resetForm),e.xp6(5),e.Q6J("ngIf",o.submitted&&(null==o.resetFrm.password.errors?null:o.resetFrm.password.errors.required)),e.xp6(1),e.Q6J("ngIf",o.submitted&&(null==o.resetFrm.password.errors?null:o.resetFrm.password.errors.pattern)),e.xp6(5),e.Q6J("ngIf",o.submitted&&(null==o.resetFrm.confirmPassword.errors?null:o.resetFrm.confirmPassword.errors.required)),e.xp6(1),e.Q6J("ngIf",o.submitted&&(null==o.resetFrm.confirmPassword.errors?null:o.resetFrm.confirmPassword.errors.notSame)),e.xp6(4),e.Q6J("routerLink",e.DdM(6,ue)))},dependencies:[p.O5,l.rH,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u,b.Nt]}),s})()}];let de=(()=>{class s{}return s.\u0275fac=function(r){return new(r||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[p.ez,l.Bz.forChild(me),te.I,re.x]}),s})()}}]);